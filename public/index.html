<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <link rel="shortcut icon" href="%PUBLIC_URL%/assets/favicon.png"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="theme-color" content="#FFFFFF"/>
    <meta name="description" content="Talk Messaging Platform Desktop Application"/>
    <link rel="apple-touch-icon" href="%PUBLIC_URL%/assets/apple-touch.png"/>
    <link rel="manifest" href="%PUBLIC_URL%/manifest.json"/>
    <title>Talk Desktop</title>
</head>
<body style="opacity: 0; overflow: hidden !important; background-color: #e5e8ec">
<noscript>You need to enable JavaScript to run this app.</noscript>

<div id="electron-container">
    <!-- Title Bar -->
    <div id="title-bar">
        <div id="title-bar-menu">
            <button id="menu-bar-btn">☰</button>
            <div id="menu-wrapper">
                <ul>
                    <!--<li>Check for updates</li>-->
                    <li id="menu-about">About Talk Desktop</li>
                    <!--<hr>-->
                    <!--<li id="menu-signout">Change Account</li>-->
                    <li id="menu-quit">Quit Talk</li>
                </ul>
            </div>
        </div>
        <div id="title">T a l k &nbsp; D e s k t o p</div>
        <div id="title-bar-btns">
            <button id="min-btn"></button>
            <button id="max-btn"></button>
            <button id="close-btn">✕</button>
        </div>
    </div>

    <!-- React Content -->
    <div id="content"></div>

    <!-- Modals -->

    <div id="about-modal" class="modal-wrapper">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <span class="modal-close">✕</span>
            <h4>درباره تاک دسکتاپ</h4>
            <p>جهت استفاده از نسخه ی وب به آدرس <a target="_blank" href="https://talk.pod.land">talk.pod.land</a> مراجعه
                نمائید. این نرم
                افزار تحت لیسانس
                <a target="_blank" href="https://github.com/masoudmanson/talk-electron/blob/master/LICENSE">MIT</a> می
                باشد.
            </p>
            <p>در صورت مواجه با هر گونه خطایی لطفا با تیم چت در ارتباط باشید.</p>
            <img src="%PUBLIC_URL%/assets/talk-logo.png" alt="Talk Desktop">
            <small class="version">Talk Desktop - Version 0.1.26</small>
        </div>
    </div>
</div>

<script>
    (function () {
        const {remote, ipcRenderer} = require('electron');
        const path = require("path");

        var TMP = {maximized: false};
        var menuState = false;
        var modalState = false;

        function init() {
            /*
             * Title Bar Buttons
             */
            document.getElementById("min-btn").addEventListener("click", function (e) {
                const window = remote.getCurrentWindow();
                window.minimize();
            });

            document.getElementById("max-btn").addEventListener("click", function (e) {
                const window = remote.getCurrentWindow();

                if (TMP.maximized == true) {
                    window.unmaximize();
                    TMP.maximized = false;
                } else {
                    window.maximize();
                    TMP.maximized = true;
                }
            });

            document.getElementById("close-btn").addEventListener("click", function (e) {
                const window = remote.getCurrentWindow();
                window.close();
            });

            /*
             * Title BAr Left Menu
             */

            document.querySelector('#content').addEventListener("click", function (e) {
                document.getElementById('menu-wrapper').style.display = "none";
                menuState = false;
            });

            document.getElementById("title-bar-menu").addEventListener("click", function (e) {
                e.preventDefault();
                if (menuState) {
                    document.getElementById('menu-wrapper').style.display = "none";
                    menuState = false;
                } else {
                    document.getElementById('menu-wrapper').style.display = "block";
                    menuState = true;
                }
            });

            document.getElementById("menu-quit").addEventListener("click", function (e) {
                ipcRenderer.send('quit-app');
            });

            document.getElementById("menu-about").addEventListener("click", function (e) {
                document.getElementById("about-modal").style.display = "flex";
                modalState = "about-modal";
            });

            var modalOverlays = document.getElementsByClassName('modal-overlay');
            for (var i = 0; i < modalOverlays.length; i++) {
                modalOverlays[i].addEventListener('click', function () {
                    var modals = document.getElementsByClassName('modal-wrapper');
                    for (var j = 0; j < modals.length; j++) {
                        modals[j].style.display = 'none';
                    }
                });
            }

            var modalCloses = document.getElementsByClassName('modal-close');
            for (var i = 0; i < modalCloses.length; i++) {
                modalCloses[i].addEventListener('click', function () {
                    var modals = document.getElementsByClassName('modal-wrapper');
                    for (var j = 0; j < modals.length; j++) {
                        modals[j].style.display = 'none';
                    }
                });
            }
        };

        document.onreadystatechange = function () {
            if (document.readyState == "complete") {
                document.getElementsByTagName("BODY")[0].style.opacity = 1;
                init();
            }
        };
    })();
</script>
</body>
</html>
