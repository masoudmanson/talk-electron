<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <link rel="shortcut icon" href="%PUBLIC_URL%/assets/favicon.png"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="theme-color" content="#FFFFFF"/>
    <meta name="description" content="Talk Messaging Platform Desktop Application"/>
    <link rel="apple-touch-icon" href="%PUBLIC_URL%/assets/apple-touch.png"/>
    <link rel="manifest" href="%PUBLIC_URL%/manifest.json"/>
    <title>Talk Desktop</title>
</head>
<body>
<noscript>You need to enable JavaScript to run this app.</noscript>
<div id="title-bar">
    <div id="title-bar-menu">
        <button id="menu-bar-btn">☰</button>
        <div id="menu-wrapper">
            <ul>
                <li>Check for updates</li>
                <li id="menu-about">About Talk Desktop</li>
                <hr>
                <!--<li id="menu-signout">Change Account</li>-->
                <li id="menu-quit">Quit Talk</li>
            </ul>
        </div>
    </div>
    <div id="title">T a l k &nbsp; D e s k t o p</div>
    <div id="title-bar-btns">
        <button id="min-btn"></button>
        <button id="max-btn"></button>
        <button id="close-btn">✕</button>
    </div>
</div>
<div id="content"></div>

<div id="modal-overlay"></div>

<div id="about-modal" class="modal-wrapper">
    <div class="modal-content">
        <h4>درباره تاک دسکتاپ</h4>
        <p>جهت استفاده از نسخه ی وب به آدرس <a href="https://talk.pod.land">talk.pod.land</a> مراجعه نمائید. این نرم
            افزار تحت لیسانس
            <a href="https://github.com/masoudmanson/talk-electron/blob/master/LICENSE">MIT License</a> می باشد.</p>
        <p>لطفا در صورت مواجه با هر گونه خطایی با تیم چت در ارتباط باشید.</p>
        <img src="%PUBLIC_URL%/assets/logo.png" alt="Talk Desktop">
        <small class="version">Version 0.1.26</small>
    </div>
</div>

<script>
    (function () {
        const {remote, ipcRenderer, shell} = require('electron');
        const path = require("path");

        var TMP = {maximized: false};
        var menuState = false;
        var modalState = false;

        document.querySelector('#content').addEventListener("click", function (e) {
            document.getElementById('menu-wrapper').style.display = "none";
            menuState = false;
        });

        document.getElementById("title-bar-menu").addEventListener("click", function (e) {
            e.preventDefault();
            if (menuState) {
                document.getElementById('menu-wrapper').style.display = "none";
                menuState = false;
            } else {
                document.getElementById('menu-wrapper').style.display = "block";
                menuState = true;
            }
        });

        document.getElementById("menu-quit").addEventListener("click", function (e) {
            ipcRenderer.send('quit-app');
        });

        document.getElementById("menu-about").addEventListener("click", function (e) {
            document.getElementById("about-modal").style.display = "flex";
            document.getElementById("modal-overlay").style.display = "block";
            modalState = "about-modal";
        });

        document.querySelector('#about-modal a').on('click', (e) => {
            e.preventDefault();
            let link = e.target.href;
            shell.openExternal(link);
        });

        function init() {
            document.getElementById("min-btn").addEventListener("click", function (e) {
                const window = remote.getCurrentWindow();
                window.minimize();
            });

            document.getElementById("max-btn").addEventListener("click", function (e) {
                const window = remote.getCurrentWindow();

                if (TMP.maximized == true) {
                    window.unmaximize();
                    TMP.maximized = false;
                } else {
                    window.maximize();
                    TMP.maximized = true;
                }
            });

            document.getElementById("close-btn").addEventListener("click", function (e) {
                const window = remote.getCurrentWindow();
                window.close();
            });
        };

        document.onreadystatechange = function () {
            if (document.readyState == "complete") {
                init();
            }
        };
    })();
</script>
</body>
</html>
